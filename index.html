<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>è¬è§£ãã‚¢ãƒ—ãƒªç¬¬ï¼”å¼¾ï¼šã¨ã†ã›ã„ã®è¬ï¼ˆãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ï¼‰</title>
<style>
  :root{
    --bg:#fff7fb; --card:#ffffff; --text:#1f2937; --muted:#6b7280;
    --accent:#ff7ac6; --ok:#16a34a; --ng:#ef4444; --ring:#ffd5ec;
    --gold:#ffcc66; --spark:#fff2a8;
  }
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#fff7fb 0%, #f5fbff 100%);
    color:var(--text);
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,Arial,sans-serif;
    -webkit-tap-highlight-color:transparent;
  }
  .wrap{max-width:900px; margin:0 auto; padding:20px 16px 64px;}
  header{display:flex; align-items:center; gap:12px; margin:6px 0 10px;}
  header h1{font-size:26px; margin:0;}
  .mascot{width:40px; height:40px; border-radius:12px; box-shadow:0 6px 16px rgba(0,0,0,.08);}
  .card{background:var(--card); border-radius:20px; box-shadow:0 10px 24px rgba(255,122,198,.15);
        padding:18px; margin:14px 0; border:2px solid var(--ring);}
  .question{font-size:20px; font-weight:800; margin:8px 0 4px;}
  .lead{color:var(--muted); margin-top:2px;}
  .choices{display:grid; gap:10px; margin-top:12px;}
  .choice-btn{width:100%; text-align:left; padding:14px 16px; border-radius:16px; border:2px solid #e7f2ff; background:#fff; cursor:pointer; font-size:16px;}
  .choice-btn:hover{border-color:#cfe7ff; background:#f7fbff;}
  .result{margin-top:10px; font-weight:900; font-size:18px;}
  .ok{color:var(--ok);} .ng{color:var(--ng);}
  .subtitle{font-weight:900; color:#1f2937; margin:6px 0 10px; font-size:18px;}
  .muted-box{background:#fff5fa; border:2px dashed #ffd2ea; padding:10px 12px; border-radius:14px; color:#374151;}
  .explain{margin-top:12px; text-align:left; background:#f7fbff; border:2px solid #dbeafe; border-radius:14px; padding:12px;}
  .fade{animation:fade .25s ease;}
  @keyframes fade{from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none}}
  @media (max-width:560px){
    header h1{font-size:22px}
    .question{font-size:18px}
    .choice-btn{font-size:15px; padding:14px}
    .btn{width:100%}
  }

  .btn{
    display:inline-block; padding:14px 18px; border-radius:16px; border:none; cursor:pointer; font-size:16px;
    background:linear-gradient(90deg,var(--accent),#ffa7d8); color:#fff; box-shadow:0 8px 18px rgba(255,122,198,.35);
  }
  .btn:disabled{opacity:.6; cursor:not-allowed;}
  .btn.alt{background:linear-gradient(90deg,#8ec5ff,#b5e1ff);}
  .btn.ghost{ background:#fff; color:#ff4fae; border:2px solid #ffb4df; box-shadow:none; }

  .form-vertical{display:flex; flex-direction:column; gap:12px;}
  label{font-size:14px; color:#6b7280; margin-bottom:6px;}
  input{
    width:100%; padding:14px 14px; font-size:16px; border-radius:14px; border:2px solid #ffdff0; background:#fff; outline:none;
  }
  input:focus{border-color:#ffb3dc; box-shadow:0 0 0 4px #ffe6f4;}

  .hero{
    display:flex; flex-direction:column; align-items:center; text-align:center; gap:10px;
  }
  .hero img{ width:min(68vw, 300px); height:auto; border-radius:24px; box-shadow:0 10px 26px rgba(0,0,0,.12); }
  .speech{
    background:#ffffff; border:2px solid #ffd5ec; border-radius:18px; padding:12px 14px; line-height:1.7;
    position:relative; max-width:680px;
  }
  .speech:after{
    content:""; position:absolute; top:100%; left:50%; transform:translateX(-50%);
    border:10px solid transparent; border-top-color:#ffd5ec;
  }
  .speech:before{
    content:""; position:absolute; top:calc(100% + 2px); left:50%; transform:translateX(-50%);
    border:10px solid transparent; border-top-color:#ffffff;
  }

  .stamp{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(255,255,255,.75); z-index:50;}
  .stamp img{width:min(70vw,380px); height:auto; filter:drop-shadow(0 10px 24px rgba(0,0,0,.2)); animation:pop .5s ease;}
  @keyframes pop{0%{transform:scale(.6) rotate(-6deg); opacity:0}60%{transform:scale(1.05) rotate(2deg); opacity:1}100%{transform:scale(1) rotate(0)}}

  #screen-ending{ position:relative; overflow:hidden; }
  .ending-wrap{ display:flex; flex-direction:column; align-items:center; gap:12px; text-align:center; }
  .ending-title{
    font-size:24px; font-weight:900; letter-spacing:.02em;
    background:linear-gradient(90deg,#ff7ac6,#ffcc66); -webkit-background-clip:text; background-clip:text; color:transparent;
  }
  .ending-lines{
    line-height:1.9; font-size:16px; color:#374151;
    background:#fffef3; border:2px solid #ffefb6; border-radius:16px; padding:10px 14px;
  }
  .ending-badge{
    display:inline-block; padding:8px 12px; border-radius:999px;
    background:linear-gradient(90deg,#ffd591,#ffe9b6); color:#6b4000; font-weight:800; font-size:13px;
    border:1px solid #f6c66f; box-shadow:0 6px 16px rgba(255,204,102,.35);
  }
  .ending-actions{ display:flex; gap:10px; margin-top:6px; flex-wrap:wrap; justify-content:center; }

  .confetti{ pointer-events:none; position:absolute; inset:0; overflow:hidden; }
  .confetti span{
    position:absolute; top:-10px; width:10px; height:16px; opacity:.9;
    animation:fall 2.8s linear forwards; transform:rotate(0deg);
  }
  @keyframes fall{
    0%{ transform:translateY(-10px) rotate(0deg); }
    100%{ transform:translateY(120vh) rotate(540deg); }
  }
  .sparkles{ pointer-events:none; position:absolute; inset:0; }
  .spark{
    position:absolute; width:10px; height:10px; background:radial-gradient(circle, var(--spark) 0%, rgba(255,255,255,0) 70%);
    animation:blink 1.6s ease-in-out infinite;
  }
  @keyframes blink{ 0%,100%{opacity:0.2} 50%{opacity:1} }

  .fortune-wrap{ display:flex; flex-direction:column; align-items:center; gap:10px; margin-top:10px; }
  .tarot-hero{
    width:min(62vw, 260px); height:auto; border-radius:22px;
    box-shadow:0 12px 24px rgba(0,0,0,.12);
    outline:4px solid rgba(255,213,236,.6);
  }
  .fortune-lines{
    background:#ffffff; border:2px solid #ffd5ec; border-radius:16px; padding:10px 12px; line-height:1.9;
    min-height:72px; max-width:680px; text-align:left;
  }
  .fortune-line{ opacity:0; transform:translateY(4px); animation:fade .3s ease forwards; }

  .tarot-table{display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap;}
  .tarot-card{
    width:96px; height:140px; border-radius:12px;
    background:linear-gradient(180deg,#fff8fb,#ffe6f4);
    border:2px solid #ffc9e8; box-shadow:0 6px 16px rgba(255,122,198,.25);
    display:flex; align-items:center; justify-content:center; font-weight:800; color:#7a2856; position:relative;
  }
  .tarot-card .cap{
    position:absolute; bottom:6px; left:0; right:0; text-align:center; font-size:12px; color:#92415f;
  }
  .tarot-card.reversed{ transform:rotate(180deg); }

  .advice-title{
    font-weight:800; color:#7a2856; margin-top:14px; font-size:17px; text-align:left;
    background:#fff5fa; border-left:5px solid #ffb8e0; padding:8px 10px; border-radius:10px;
    animation:fade .6s ease;
  }

  /* æ˜Ÿåº§é¸æŠç”¨ */
  .zodiac-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
    gap:8px;
    margin-top:10px;
  }
  .zodiac-btn{
    padding:10px 12px;
    border-radius:14px;
    border:2px solid #ffe0f2;
    background:#ffffff;
    cursor:pointer;
    font-size:14px;
    text-align:center;
    line-height:1.4;
  }
  .zodiac-btn span{
    display:block;
    font-size:12px;
    color:#9ca3af;
  }
  .zodiac-btn:hover{
    background:#fff7fc;
    border-color:#ffb3dc;
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="mame2.png" alt="ã¨ã›ã„ãã‚“ï¼ˆç¬¬4å¼¾ï¼‰" class="mascot" />
      <h1>ç¬¬ï¼”å¼¾ï¼šã¨ã†ã›ã„ã®è¬ï¼ˆãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ï¼‰</h1>
    </header>

    <!-- 1ãƒšãƒ¼ã‚¸ç›®ï¼šã‚ˆã†ã“ãï¼†ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ› -->
    <section id="screen-intro" class="card fade">
      <div class="hero">
        <img src="mame2.png" alt="ã¨ã›ã„ãã‚“ï¼ˆç¬¬4å¼¾ï¼‰" />
        <div class="speech">
          <strong>ã¼ãã¯ ã¨ã›ã„ãã‚“ã€‚</strong><br>
          <strong>TMC(ã¨ã†ã›ã„ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ã‚«ãƒƒãƒ—ï¼‰ã®ãƒã‚¹ã‚³ãƒƒãƒˆã‚­ãƒ£ãƒ©ã ã‚ˆã€‚</strong><br>
          <strong>ç¬¬ï¼”å¼¾ ã¨ã†ã›ã„ã®è¬</strong>ã¸ã‚ˆã†ã“ãï¼<br>
          ã¾ãšã¯ã‚ãªãŸã®ã“ã¨<strong>æ•™ãˆã¦ï¼</strong>
        </div>
      </div>

      <div style="height:8px;"></div>

      <div class="form-vertical">
        <div>
          <label for="name">åå‰</label>
          <input id="name" type="text" placeholder="ä¾‹ï¼‰ãƒ•ãƒ«ãƒãƒ¼ãƒ " />
        </div>
        <div>
          <label for="group">æ‰€å±</label>
          <input id="group" type="text" placeholder="ä¾‹ï¼‰å¤–æ¥ï¼ã€‡ã€‡ç—…æ£Ÿï¼ãƒªãƒ ãªã©" />
        </div>
        <div>
          <label for="job">è·ç¨®</label>
          <input id="job" type="text" placeholder="ä¾‹ï¼‰çœ‹è­·å¸«ï¼åŒ»å¸«ï¼è–¬å‰¤å¸« ãªã©" />
        </div>
      </div>

      <div style="margin-top:16px;">
        <button class="btn" id="go-pre" onclick="goPre()">æ¬¡ã¸</button>
      </div>
    </section>

    <!-- 2ãƒšãƒ¼ã‚¸ç›®ï¼šæ˜Ÿåº§é¸æŠç”»é¢ -->
    <section id="screen-pre" class="card fade" style="display:none;">
      <div style="text-align:center; margin:10px 0;">
        <img src="./toseiuranai.png" alt="æ˜Ÿå ã„ã‚’ã™ã‚‹ ã¨ã›ã„ãã‚“" class="tarot-hero" />
      </div>
      <div class="muted-box" style="margin:10px 0 14px;">
        <strong id="pre-title">ç¬¬ï¼”å¼¾ã€ã¨ã†ã›ã„ã®è¬ï¼ˆãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ï¼‰ã€ã¸ã‚ˆã†ã“ãï¼</strong><br>
        ä»Šå›ã¯<strong>æ˜Ÿå ã„</strong>ã ã‚ˆã€‚æ˜Ÿåº§ã«ã‚ˆã£ã¦<strong>2025å¹´11æœˆã®é‹å‹¢</strong>ã‚’å ã£ã¦ã¿ã‚ˆã†ï¼<br>
        ã‚ãªãŸã®æ˜Ÿåº§ã‚’æ•™ãˆã¦ã­ã€‚
      </div>

      <div class="zodiac-grid">
        <button class="zodiac-btn" onclick="selectZodiac('aries')">ãŠã²ã¤ã˜åº§<span>Aries</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('taurus')">ãŠã†ã—åº§<span>Taurus</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('gemini')">ãµãŸã”åº§<span>Gemini</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('cancer')">ã‹ã«åº§<span>Cancer</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('leo')">ã—ã—åº§<span>Leo</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('virgo')">ãŠã¨ã‚åº§<span>Virgo</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('libra')">ã¦ã‚“ã³ã‚“åº§<span>Libra</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('scorpio')">ã•ãã‚Šåº§<span>Scorpio</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('sagittarius')">ã„ã¦åº§<span>Sagittarius</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('capricorn')">ã‚„ãåº§<span>Capricorn</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('aquarius')">ã¿ãšãŒã‚åº§<span>Aquarius</span></button>
        <button class="zodiac-btn" onclick="selectZodiac('pisces')">ã†ãŠåº§<span>Pisces</span></button>
      </div>
    </section>

    <!-- 3ãƒšãƒ¼ã‚¸ç›®ï¼šæ˜Ÿåº§åˆ¥ã®2025å¹´11æœˆã®é‹å‹¢ï¼‹ãŒã‚“ã®å°å…¥ -->
    <section id="screen-diag-result" class="card fade" style="display:none;">
      <div id="type-title" class="question">ã¨ã›ã„ãã‚“ã®æ˜Ÿåº§å ã„</div>
      <div id="type-copy" class="lead"></div>

      <div class="fortune-wrap">
        <img src="mame2.png" alt="æ˜Ÿã‚’è¦‹ä¸Šã’ã‚‹ã¨ã›ã„ãã‚“" class="tarot-hero" />
        <div class="tarot-table" id="tarot-table"></div>
        <div id="fortune-lines" class="fortune-lines"></div>
      </div>

      <div id="advice-title" class="advice-title" style="display:none;">
        ğŸ”­ 2025å¹´11æœˆã®ãƒ©ãƒƒã‚­ãƒ¼ã‚¢ãƒ‰ãƒã‚¤ã‚¹
      </div>
      <ul id="type-desc" style="text-align:left; line-height:1.8; margin-top:8px;"></ul>

      <div class="muted-box" style="margin-top:12px; line-height:1.9; text-align:left;">
        <p><strong>æ˜Ÿåº§å ã„ã¯ã©ã†ã ã£ãŸï¼Ÿ</strong></p>
        <p>ã¼ãã¯<strong>èŸ¹åº§</strong>ãªã‚“ã ã‘ã©ã€èŸ¹åº§ã£ã¦è‹±èªã§è¨€ã†ã¨ãªã‚“ã¦èª­ã‚€ã‹çŸ¥ã£ã¦ã‚‹ï¼Ÿï¼Ÿ</p>
        <p>ãã†ï¼ <strong>Cancerï¼ˆã‚­ãƒ£ãƒ³ã‚µãƒ¼ï¼‰</strong>ã€‚ã‚ã‚Œã‚Œâ€¦ã©ã“ã‹ã§èã„ãŸã“ã¨ãŒã‚ã‚‹ç—…æ°—ã¨åŒã˜ã â€¦ã€‚</p>
        <p>ä»Šã‚„<strong>2äººã«1äººãŒç½¹ã‚‹</strong>ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã€Œç™Œã€ã¨åŒã˜ãªã‚“ã ã‚ˆã­ã€‚</p>
        <p>ä¹³ç™Œã®ã—ã“ã‚ŠãŒã€èŸ¹ãŒå¼µã‚Šä»˜ã„ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã“ã¨ã‹ã‚‰ã€ã€ŒèŸ¹ã€ã‚’æ„å‘³ã™ã‚‹ã‚®ãƒªã‚·ãƒ£èªãŒèªæºã ã£ã¦è©±ï¼ãµã‚€ãµã‚€â€¦</p>
        <p><strong>ãªã‚“ã ã‹ã‚‚ã†å°‘ã—ã€ŒãŒã‚“ã€ã®ã“ã¨ãŒçŸ¥ã‚ŠãŸããªã£ã¦ããŸï¼ï¼</strong><br>
        ã•ã‚ã€ãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ã€å¤šè·ç¨®é€£æºã«ã¤ã„ã¦ã®<strong>è¬è§£ãã‚¯ã‚¤ã‚º</strong>ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã‚ˆã†ã€‚</p>
      </div>

      <div class="muted-box" style="margin-top:10px;">
        ãã‚Œã§ã¯ã€<strong>ç¬¬ï¼”å¼¾ï¼šã¨ã†ã›ã„ã®è¬ï¼ˆãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ç·¨ï¼‰</strong>ã®ç¬¬1å•ã¸ï¼<br/>
        ã‚ãªãŸã®çŸ¥è­˜ã‚’ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã•ã›ã‚ˆã†ï¼
      </div>
      <button class="btn" id="to-quiz" onclick="toQuiz()" style="margin-top:14px;">ç¬¬1å•ã¸é€²ã‚€</button>
    </section>

    <!-- 4ã€œ6ãƒšãƒ¼ã‚¸ç›®ï¼šã‚¯ã‚¤ã‚ºï¼ˆ3å•ï¼‰ -->
    <section id="screen-quiz" class="card fade" style="display:none;">
      <div id="story" class="lead" style="margin-bottom:8px;"></div>
      <div style="text-align:center; margin:10px 0;">
        <img id="quiz-img" src="mame2.png" alt="ã¨ã›ã„ãã‚“" style="max-width:140px; border-radius:14px; box-shadow:0 4px 12px rgba(0,0,0,0.1);" />
      </div>
      <div id="q-title" class="question"></div>
      <div id="choices" class="choices"></div>
      <div id="judge" class="result"></div>
      <div id="explain" class="explain" style="display:none;"></div>
      <div id="next-area" style="display:none; margin-top:12px;">
        <button id="next-btn" class="btn" onclick="goNext()">æ¬¡ã¸</button>
      </div>
    </section>

    <!-- 7ãƒšãƒ¼ã‚¸ç›®ï¼šã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚° -->
    <section id="screen-ending" class="card fade" style="display:none;">
      <div class="ending-wrap">
        <div class="ending-title">ğŸ‰ ã‚¯ãƒªã‚¢ãŠã‚ã§ã¨ã†ï¼ï¼ˆç¬¬ï¼”å¼¾ï¼‰</div>
        <img src="nazotoki2.png" alt="ã¨ã›ã„ãã‚“" class="tarot-hero" />

        <div class="ending-lines">
          <div class="ending-badge">ã¨ã†ã›ã„ã®è¬ãƒ»ãŒã‚“é€£æºãƒã‚¹ã‚¿ãƒ¼</div>
          <div id="ending-text" style="margin-top:6px;"></div>
          <div style="margin-top:6px;">
            TMCã®ã“ã¨ã§èããŸã„ã“ã¨ãŒã‚ã‚Œã°ã€ã„ã¤ã§ã‚‚ <strong>PHS6693</strong> ã«é€£çµ¡ã—ã¦ã­ã€‚
          </div>
        </div>
        <div class="ending-actions">
          <button class="btn ghost" id="finish-btn">ä»Šå›ã®èª¿æŸ»ã‚’çµ‚äº†ã™ã‚‹</button>
        </div>
        <div id="finish-message" style="display:none; margin-top:10px; font-weight:800; color:#374151;">
          ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
        </div>
      </div>
      <div class="confetti" id="confetti"></div>
      <div class="sparkles" id="sparkles"></div>
    </section>
  </div>

  <div id="stamp" class="stamp" aria-hidden="true">
    <img src="nazotoki2.png" alt="æ­£è§£ã‚¹ã‚¿ãƒ³ãƒ—" />
  </div>

  <audio id="bgm" src="nazotoki2.mp3" preload="none" loop></audio>
  <audio id="seClick" src="pochi.mp3" preload="auto"></audio>
  <audio id="seCorrect" src="pinpon.mp3" preload="auto"></audio>
  <audio id="seClear" src="seikou.mp3" preload="auto"></audio>

<script>
const GOOGLE_FORM_ACTION = 

const ENTRY_NAME = "entry.6";
const ENTRY_DEPT = "entry.2";
const ENTRY_JOB  = "entry.6";

function sendToGoogleForm({ name, dept, job }) {
  const fd = new FormData();
  fd.append(ENTRY_NAME, name);
  fd.append(ENTRY_DEPT, dept);
  fd.append(ENTRY_JOB, job);
  fetch(GOOGLE_FORM_ACTION, {
    method: "POST",
    body: fd,
    mode: "no-cors"
  });
}

const nameEl  = document.getElementById('name');
const groupEl = document.getElementById('group');
const jobEl   = document.getElementById('job');

const screenIntro = document.getElementById('screen-intro');
const screenPre   = document.getElementById('screen-pre');
const screenDiagResult = document.getElementById('screen-diag-result');
const screenQuiz  = document.getElementById('screen-quiz');
const screenEnding= document.getElementById('screen-ending');

const preTitle = document.getElementById('pre-title');
const stampEl = document.getElementById('stamp');

const storyEl = document.getElementById('story');
const qTitleEl = document.getElementById('q-title');
const choicesEl = document.getElementById('choices');
const judgeEl = document.getElementById('judge');
const explainEl = document.getElementById('explain');
const nextArea = document.getElementById('next-area');
const nextBtn  = document.getElementById('next-btn');
const endingText = document.getElementById('ending-text');
const quizImgEl = document.getElementById('quiz-img');
const confettiEl = document.getElementById('confetti');
const sparklesEl = document.getElementById('sparkles');

const fortuneLinesEl = document.getElementById('fortune-lines');
const finishBtn = document.getElementById('finish-btn');
const finishMessage = document.getElementById('finish-message');
const tarotTable = document.getElementById('tarot-table');

const bgm = document.getElementById('bgm');
const seClick = document.getElementById('seClick');
const seCorrect = document.getElementById('seCorrect');
const seClear = document.getElementById('seClear');
let bgmStarted = false;

function playClick(){ try{ seClick.currentTime = 0; seClick.play(); }catch(e){} }
function playCorrect(){ try{ seCorrect.currentTime = 0; seCorrect.play(); }catch(e){} }
function ensureBGM(){
  if(!bgmStarted){
    bgmStarted = true;
    try{ bgm.volume = 0.8; bgm.play(); }catch(e){}
  }
}

document.addEventListener('click', function(e){
  const btn = e.target.closest('button');
  if (!btn) return;
  if (btn.classList.contains('choice-btn')) return;
  playClick();
}, true);

function hideAll(){ [screenIntro,screenPre,screenDiagResult,screenQuiz,screenEnding].forEach(e=>e.style.display='none'); }
function show(el){ hideAll(); el.style.display='block'; window.scrollTo({top:0,behavior:'smooth'}); }
show(screenIntro);

window.goPre = function(){
  if(!nameEl.value.trim()){ nameEl.focus(); nameEl.style.borderColor='#ff8dc7'; return; }
  nameEl.style.borderColor='#ffdff0';
  preTitle.textContent = "ç¬¬ï¼”å¼¾ã€ã¨ã†ã›ã„ã®è¬ï¼ˆãŒã‚“ã¨ç·©å’Œã‚±ã‚¢ï¼‰ã€ã¸ã‚ˆã†ã“ãã€ " + nameEl.value + " ã•ã‚“ã€‚ã¾ãšã¯ã‚ãªãŸã®æ˜Ÿåº§ã‚’æ•™ãˆã¦ã­ã€‚";
  sendToGoogleForm({ name: nameEl.value, dept: groupEl.value, job: jobEl.value });
  show(screenPre);
};

/* ===== æ˜Ÿåº§åˆ¥ 2025å¹´11æœˆã®é‹å‹¢ãƒ‡ãƒ¼ã‚¿ ===== */
const zodiacData = {
  aries: {
    label: "ãŠã²ã¤ã˜åº§ï¼ˆAriesï¼‰",
    keyword: "ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã¨ã‚¹ã‚¿ãƒ¼ãƒˆ",
    lines: [
      "2025å¹´11æœˆã¯ã€ã€Œã‚„ã£ã¦ã¿ã‚ˆã†ï¼ã€ã®ä¸€æ­©ãŒå¤§ããªæˆé•·ã«ã¤ãªãŒã‚‹æœˆã€‚",
      "æ–°ã—ã„ä¿‚ã‚„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æ‰‹ã‚’æŒ™ã’ã‚‹ã¨ã€æ€ã£ãŸä»¥ä¸Šã«æ¥½ã—ããªã‚Šãã†ã€‚",
      "ã¡ã‚‡ã£ã¨ãƒ‰ã‚­ãƒ‰ã‚­ã™ã‚‹å ´é¢ã§ã‚‚ã€ã‚ãªãŸã®è¡Œå‹•åŠ›ãŒãƒãƒ¼ãƒ ã‚’å‰ã«é€²ã‚ã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "æ°—ã«ãªã‚‹å‹‰å¼·ä¼šã‚„ç ”ä¿®ã«ã²ã¨ã¤å‚åŠ ã—ã¦ã¿ã‚‹ã€‚",
      "ã€Œã“ã‚Œãªã‚‰ã§ããã†ã€ã¨ã„ã†å°ã•ãªç›®æ¨™ã‚’1ã¤æ±ºã‚ã¦å–ã‚Šçµ„ã‚€ã€‚"
    ]
  },
  taurus: {
    label: "ãŠã†ã—åº§ï¼ˆTaurusï¼‰",
    keyword: "ã˜ã£ãã‚Šæ•´ãˆã‚‹",
    lines: [
      "2025å¹´11æœˆã¯ã€ç’°å¢ƒã‚„æŒã¡ç‰©ã‚’æ•´ãˆã‚‹ã“ã¨ã§é‹æ°—ã‚¢ãƒƒãƒ—ã€‚",
      "ãƒ‡ã‚¹ã‚¯ã¾ã‚ã‚Šã‚„ãƒ­ãƒƒã‚«ãƒ¼ã‚’ç‰‡ã¥ã‘ã‚‹ã¨ã€ä»•äº‹ã®ãƒŸã‚¹ã‚‚æ¸›ã£ã¦ã‚¹ãƒƒã‚­ãƒªã€‚",
      "ä¸å¯§ãªç¢ºèªä½œæ¥­ãŒã€æ‚£è€…ã•ã‚“ã‚„ä»²é–“ã‹ã‚‰ã®ä¿¡é ¼ã«ã¤ãªãŒã‚Šãã†ã€‚"
    ],
    tips: [
      "1æ—¥5åˆ†ã ã‘ã€Œç‰‡ã¥ã‘ã‚¿ã‚¤ãƒ ã€ã‚’ä½œã£ã¦ã¿ã‚‹ã€‚",
      "æ°—ã«ãªã‚‹æ›¸é¡ã‚„ãƒ¡ãƒ¢ã¯ã€1ã‹æ‰€ã«ã¾ã¨ã‚ã¦ç®¡ç†ã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  gemini: {
    label: "ãµãŸã”åº§ï¼ˆGeminiï¼‰",
    keyword: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
    lines: [
      "2025å¹´11æœˆã¯ã€ã€Œã¡ã‚‡ã£ã¨ä¸€è¨€ã€ãŒå‘¨ã‚Šã‚’æ˜ã‚‹ãã™ã‚‹æœˆã€‚",
      "é›‘è«‡ã‚„å£°ã‹ã‘ã‹ã‚‰ã€å½¹ç«‹ã¤æƒ…å ±ã‚„æ–°ã—ã„é€£æºãŒç”Ÿã¾ã‚Œãã†ã€‚",
      "æ‚£è€…ã•ã‚“ã¸ã®èª¬æ˜ã‚‚ã€ã‚ãªãŸãªã‚‰ã§ã¯ã®è¨€è‘‰ã§åˆ†ã‹ã‚Šã‚„ã™ãä¼ãˆã‚‰ã‚Œã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "1æ—¥1å›ã€åŒåƒšã«ã€Œã‚ã‚ŠãŒã¨ã†ã€ã‚’è¨€è‘‰ã«ã—ã¦ä¼ãˆã‚‹ã€‚",
      "ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ã¯ã€è³ªå•ã‚’1ã¤ã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  cancer: {
    label: "ã‹ã«åº§ï¼ˆCancerï¼‰",
    keyword: "ã‚„ã•ã—ã•ã¨å®‰å¿ƒæ„Ÿ",
    lines: [
      "2025å¹´11æœˆã¯ã€ã‚ãªãŸã®ã€ŒèãåŠ›ã€ãŒå¤§ããªæ”¯ãˆã«ãªã‚‹æœˆã€‚",
      "æ‚£è€…ã•ã‚“ã‚„ã‚¹ã‚¿ãƒƒãƒ•ã®æœ¬éŸ³ã‚’å¼•ãå‡ºã™èãå½¹ã¨ã—ã¦æ´»èºã—ãã†ã€‚",
      "è‡ªåˆ†è‡ªèº«ã®å¿ƒã¨ä½“ã®ã‚±ã‚¢ã‚‚å¿˜ã‚Œãšã«ã€ã‚†ã£ãã‚Šä¼‘ã‚€æ™‚é–“ã‚‚å¤§åˆ‡ã«ã—ã¦ã­ã€‚"
    ],
    tips: [
      "1æ—¥ã®çµ‚ã‚ã‚Šã«ã€ä»Šæ—¥ã§ããŸã“ã¨ã‚’3ã¤æ›¸ãå‡ºã—ã¦ã¿ã‚‹ã€‚",
      "ä¼‘æ†©ä¸­ã«æ¸©ã‹ã„é£²ã¿ç‰©ã‚’é£²ã‚“ã§ã²ã¨æ¯ã¤ãã€‚"
    ]
  },
  leo: {
    label: "ã—ã—åº§ï¼ˆLeoï¼‰",
    keyword: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—",
    lines: [
      "2025å¹´11æœˆã¯ã€è‡ªç„¶ã¨å‘¨ã‚Šã‚’å¼•ã£å¼µã‚‹å½¹å‰²ãŒå›ã£ã¦ããã†ã€‚",
      "å‰å‘ããªä¸€è¨€ã‚„è¡Œå‹•ãŒã€ãƒãƒ¼ãƒ å…¨ä½“ã®é›°å›²æ°—ã‚’æ˜ã‚‹ãã™ã‚‹ã‚ˆã€‚",
      "å®Œç’§ã§ãªãã¦ã‚‚OKã€‚ç¬‘é¡”ã§é€²ã‚“ã§ã„ãå§¿ãŒã€ã¿ã‚“ãªã®å‹‡æ°—ã«ãªã‚‹ã€‚"
    ],
    tips: [
      "å›°ã£ã¦ã„ãã†ãªäººã«ã€Œä½•ã‹æ‰‹ä¼ãŠã†ã‹ï¼Ÿã€ã¨å£°ã‚’ã‹ã‘ã¦ã¿ã‚‹ã€‚",
      "ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§æ„è¦‹ã‚’1ã¤å‡ºã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  virgo: {
    label: "ãŠã¨ã‚åº§ï¼ˆVirgoï¼‰",
    keyword: "ä¸å¯§ã•ã¨å·¥å¤«",
    lines: [
      "2025å¹´11æœˆã¯ã€ã€Œä¸€æ‰‹é–“ã€ã®å·¥å¤«ãŒã‚­ãƒ©ãƒªã¨å…‰ã‚‹æœˆã€‚",
      "æƒ…å ±æ•´ç†ã‚„ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¥ãã‚ŠãŒã€ã¿ã‚“ãªã®åŠ©ã‘ã«ãªã‚Šãã†ã€‚",
      "è¦³å¯ŸåŠ›ã®é«˜ã•ãŒã€å®‰å…¨ã§è³ªã®é«˜ã„ã‚±ã‚¢ã«ã¤ãªãŒã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚"
    ],
    tips: [
      "è‡ªåˆ†ç”¨ã®ãƒŸãƒ‹ãƒ¡ãƒ¢ã‚„ã‚¹ã‚­ãƒæ™‚é–“ã®å­¦ç¿’ãƒãƒ¼ãƒˆã‚’ä½œã£ã¦ã¿ã‚‹ã€‚",
      "æ°—ã¥ã„ãŸå·¥å¤«ã¯ã€ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚„ãƒãƒ¼ãƒˆã§å…±æœ‰ã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  libra: {
    label: "ã¦ã‚“ã³ã‚“åº§ï¼ˆLibraï¼‰",
    keyword: "ãƒãƒ©ãƒ³ã‚¹ã¨èª¿æ•´",
    lines: [
      "2025å¹´11æœˆã¯ã€ä»•äº‹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ç›´ã™ã®ã«ã´ã£ãŸã‚Šã€‚",
      "ãŒã‚“ã°ã‚Šã™ããšã€äººã«é ¼ã‚‹ã“ã¨ã‚‚å¤§åˆ‡ã ã¨æ„Ÿã˜ã‚‹å ´é¢ãŒã‚ã‚‹ã‹ã‚‚ã€‚",
      "ã‚ãªãŸã®èª¿æ•´åŠ›ãŒã€ãƒãƒ¼ãƒ ã®é›°å›²æ°—ã‚’ã¾ã‚‹ããŠã•ã‚ã¦ãã‚Œã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "ã‚·ãƒ•ãƒˆã®å‰å¾Œã§ã€Œè‡ªåˆ†ã®ä¼‘ã‚€æ™‚é–“ã€ã‚’1ã¤æ±ºã‚ã¦æ„è­˜ã—ã¦ã¿ã‚‹ã€‚",
      "æ‚©ã‚“ã ã‚‰ä¸€äººã§æŠ±ãˆè¾¼ã¾ãšã€ä¿¡é ¼ã§ãã‚‹äººã«ç›¸è«‡ã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  scorpio: {
    label: "ã•ãã‚Šåº§ï¼ˆScorpioï¼‰",
    keyword: "æ·±ãå‘ãåˆã†",
    lines: [
      "2025å¹´11æœˆã¯ã€ä¸€äººã²ã¨ã‚Šã®èƒŒæ™¯ã«ç›®ã‚’å‘ã‘ã‚‹ã“ã¨ã§æ°—ã¥ããŒå¢—ãˆã‚‹æœˆã€‚",
      "æ‚£è€…ã•ã‚“ã®ä¾¡å€¤è¦³ã‚„å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã‚‹ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Šãã†ã€‚",
      "ã˜ã£ãã‚Šé–¢ã‚ã‚‹å§¿å‹¢ãŒã€å®‰å¿ƒæ„Ÿã¨ä¿¡é ¼ã«ã¤ãªãŒã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "å•è¨ºã‚„ä¼šè©±ã®ä¸­ã§ã€Œä½•ãŒä¸€ç•ªä¸å®‰ã‹ã€ã‚’èã„ã¦ã¿ã‚‹ã€‚",
      "è¨˜éŒ²ã«â€œãã®äººã‚‰ã—ã•â€ã‚’ä¸€è¨€ãƒ¡ãƒ¢ã—ã¦ãŠãã€‚"
    ]
  },
  sagittarius: {
    label: "ã„ã¦åº§ï¼ˆSAGITTARIUSï¼‰",
    keyword: "å­¦ã³ã¨å†’é™º",
    lines: [
      "2025å¹´11æœˆã¯ã€æ–°ã—ã„çŸ¥è­˜ã‚’å¸åã™ã‚‹ã®ã«ã´ã£ãŸã‚Šãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚",
      "ãŒã‚“ã‚„ç·©å’Œã‚±ã‚¢ã€å¤šè·ç¨®é€£æºãªã©ã€æ°—ã«ãªã‚‹ãƒ†ãƒ¼ãƒã‚’æ·±æ˜ã‚Šã™ã‚‹ã¨â—ã€‚",
      "å­¦ã‚“ã ã“ã¨ã‚’ã™ãã«ç¾å ´ã§è©¦ã™ã“ã¨ã§ã€è‡ªä¿¡ã«ã‚‚ã¤ãªãŒã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "æ°—ã«ãªã‚‹ãƒ†ãƒ¼ãƒã‚’1ã¤æ±ºã‚ã¦ã€ãƒ‘ãƒ³ãƒ•ãƒ¬ãƒƒãƒˆã‚„WEBã§èª¿ã¹ã¦ã¿ã‚‹ã€‚",
      "ç ”ä¿®ã‚„å‹‰å¼·ä¼šã®ã‚ã¨ã«ã€å­¦ã³ã‚’1ã¤èª°ã‹ã«ã‚·ã‚§ã‚¢ã—ã¦ã¿ã‚‹ã€‚"
    ]
  },
  capricorn: {
    label: "ã‚„ãåº§ï¼ˆCapricornï¼‰",
    keyword: "ã‚³ãƒ„ã‚³ãƒ„ã¨ç©ã¿é‡ã­",
    lines: [
      "2025å¹´11æœˆã¯ã€å°ã•ãªåŠªåŠ›ã®ç©ã¿é‡ã­ãŒã—ã£ã‹ã‚Šå®Ÿã‚’çµã¶æœˆã€‚",
      "è‹¦æ‰‹ã ã¨æ€ã£ã¦ã„ãŸã“ã¨ã‚‚ã€å°‘ã—ãšã¤æ…£ã‚Œã¦ã„ã‘ãã†ã€‚",
      "å‘¨å›²ã¯ã‚ãªãŸã®çœŸé¢ç›®ã•ã¨è²¬ä»»æ„Ÿã‚’ã¡ã‚ƒã‚“ã¨è¦‹ã¦ãã‚Œã¦ã„ã‚‹ã‚ˆã€‚"
    ],
    tips: [
      "1æ—¥1ã¤ã ã‘ã€Œä»Šæ—¥ã“ã‚Œã‚’æ„è­˜ã™ã‚‹ã€ã¨ã„ã†ãƒ†ãƒ¼ãƒã‚’æ±ºã‚ã‚‹ã€‚",
      "ã§ããŸã“ã¨ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚„æ‰‹å¸³ã«ãƒã‚§ãƒƒã‚¯ã—ã¦è¦‹ãˆã‚‹åŒ–ã™ã‚‹ã€‚"
    ]
  },
  aquarius: {
    label: "ã¿ãšãŒã‚åº§ï¼ˆAquariusï¼‰",
    keyword: "ã‚¢ã‚¤ãƒ‡ã‚¢ã¨ã¤ãªãŒã‚Š",
    lines: [
      "2025å¹´11æœˆã¯ã€ã€Œã“ã†ã—ãŸã‚‰ã‚‚ã£ã¨è‰¯ããªã‚‹ã‹ã‚‚ï¼Ÿã€ã¨ã„ã†ã²ã‚‰ã‚ããŒå¢—ãˆã‚‹æœˆã€‚",
      "ãƒãƒ¼ãƒ ã§ã®æ–°ã—ã„å–ã‚Šçµ„ã¿ã‚„å·¥å¤«ã®ææ¡ˆã«ã´ã£ãŸã‚Šã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚",
      "ã„ã¤ã‚‚ã®ã‚„ã‚Šæ–¹ã«ã€å°‘ã—ã ã‘ã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¶³ã—ã¦ã¿ã‚ˆã†ã€‚"
    ],
    tips: [
      "æ°—ã¥ã„ãŸæ”¹å–„æ¡ˆã‚’ãƒ¡ãƒ¢ã«ã—ã¦ãŠãã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹ã¦å…±æœ‰ã™ã‚‹ã€‚",
      "é•ã†è·ç¨®ã®äººã®è©±ã‚’èã„ã¦ã€è¦–ç‚¹ã®é•ã„ã‚’æ¥½ã—ã‚“ã§ã¿ã‚‹ã€‚"
    ]
  },
  pisces: {
    label: "ã†ãŠåº§ï¼ˆPiscesï¼‰",
    keyword: "å…±æ„Ÿã¨ã‚„ã•ã—ã•",
    lines: [
      "2025å¹´11æœˆã¯ã€ã‚ãªãŸã®ã‚„ã‚ã‚‰ã‹ã„é›°å›²æ°—ãŒã¿ã‚“ãªã®ç™’ã—ã«ãªã‚‹æœˆã€‚",
      "æ‚£è€…ã•ã‚“ã‚„å®¶æ—ã®æ°—æŒã¡ã«å¯„ã‚Šæ·»ã†ã“ã¨ã§ã€å¤§ããªå®‰å¿ƒã‚’å±Šã‘ã‚‰ã‚Œãã†ã€‚",
      "ãŸã ã—ã€ãŒã‚“ã°ã‚Šã™ãã¦è‡ªåˆ†ãŒç–²ã‚Œãªã„ã‚ˆã†ã«ã‚»ãƒ«ãƒ•ã‚±ã‚¢ã‚‚å¿˜ã‚Œãšã«ã€‚"
    ],
    tips: [
      "ã€Œã¤ã‚‰ã‹ã£ãŸã§ã™ã­ã€ã€Œé ‘å¼µã£ã¦ã„ã¾ã™ã­ã€ã¨å…±æ„Ÿã®ä¸€è¨€ã‚’æ„è­˜ã—ã¦ä½¿ã†ã€‚",
      "è‡ªåˆ†ã®æ°—æŒã¡ã‚‚èª°ã‹ã«è©±ã—ã¦ã€æŠ±ãˆè¾¼ã¿ã™ããªã„ã‚ˆã†ã«ã™ã‚‹ã€‚"
    ]
  }
};

function renderFortune(lines){
  fortuneLinesEl.innerHTML = "";
  let i = 0;
  (function next(){
    if(i >= lines.length) return;
    const div = document.createElement('div');
    div.className = 'fortune-line';
    div.textContent = lines[i++];
    fortuneLinesEl.appendChild(div);
    setTimeout(next, 900);
  })();
}

function showAdviceTitle(){
  const at = document.getElementById('advice-title');
  if(at){ at.style.display = 'block'; }
}

/* æ˜Ÿåº§ãŒé¸ã°ã‚ŒãŸã¨ãã®å‡¦ç†ï¼ˆ3ãƒšãƒ¼ã‚¸ç›®ã¸é·ç§»ï¼‰ */
window.selectZodiac = function(key){
  ensureBGM();
  const data = zodiacData[key];
  if(!data) return;

  const typeTitleEl = document.getElementById('type-title');
  const typeCopyEl = document.getElementById('type-copy');
  const typeDescEl = document.getElementById('type-desc');

  typeTitleEl.textContent = "ã¨ã›ã„ãã‚“ã®æ˜Ÿåº§å ã„ï¼š2025å¹´11æœˆ";
  typeCopyEl.textContent = data.label + " ã•ã‚“ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼šã€Œ" + data.keyword + "ã€";

  // æ˜Ÿã®ã‚«ãƒ¼ãƒ‰é¢¨ã‚¢ã‚¤ã‚³ãƒ³
  tarotTable.innerHTML = "";
  const cardEl = document.createElement('div');
  cardEl.className = 'tarot-card';
  cardEl.innerHTML = '<div style="font-size:32px;">â­</div><div class="cap">' + data.label + '</div>';
  tarotTable.appendChild(cardEl);

  // é‹å‹¢æœ¬æ–‡
  renderFortune(data.lines);

  // ã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒªã‚¹ãƒˆ
  typeDescEl.innerHTML = "";
  data.tips.forEach(t=>{
    const li = document.createElement('li');
    li.textContent = "ğŸ”¸ " + t;
    typeDescEl.appendChild(li);
  });

  showAdviceTitle();
  show(screenDiagResult);
};

/* ===== ãŒã‚“ãƒ»ç·©å’Œã‚±ã‚¢ã‚¯ã‚¤ã‚º ===== */
const quiz = [
  {
    story: "ğŸ¦€ ã“ã“ã‹ã‚‰ã¯ã€ŒãŒã‚“ã®æ¨™æº–æ²»ç™‚ã€ã«ã¤ã„ã¦ã®ãªãã ã‚ˆã€‚",
    title: "è¬1ï¼šãŒã‚“æ¨™æº–æ²»ç™‚ã®ã€Œ3å¤§æ²»ç™‚ã€ã¨ã¯ãªã«ã‹ãªã€‚é•ã†ã‚‚ã®ãŒ1ã¤å…¥ã£ã¦ã„ã‚‹ã‚ˆã€‚ã©ã‚Œã‹ãªï¼Ÿ",
    choices: [
      {label:"1ï¼‰åŒ–å­¦ç™‚æ³•", correct:false},
      {label:"2ï¼‰ç·©å’Œã‚±ã‚¢ç™‚æ³•", correct:true},
      {label:"3ï¼‰æ‰‹è¡“ç™‚æ³•", correct:false},
      {label:"4ï¼‰æ”¾å°„ç·šç™‚æ³•", correct:false}
    ],
    explain: [
      "æ­£è§£ã¯ â‘¡ ç·©å’Œã‚±ã‚¢ç™‚æ³•ã€‚",
      "ãŒã‚“ã®æ¨™æº–æ²»ç™‚ã¨ã¯ã€ç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãã€æœ‰åŠ¹æ€§ã¨å®‰å…¨æ€§ãŒèªã‚ã‚‰ã‚Œã¦ã„ã‚‹æ²»ç™‚æ³•ã®ã“ã¨ã€‚",
      "ä¸»ãªã‚‚ã®ã«ã€Œæ‰‹è¡“ã€ã€Œè–¬ç‰©ç™‚æ³•ï¼ˆåŒ–å­¦ç™‚æ³•ãªã©ï¼‰ã€ã€Œæ”¾å°„ç·šç™‚æ³•ã€ãŒã‚ã‚Šã€ã“ã‚Œã‚‰ã‚’ã€ŒãŒã‚“ã®ä¸‰å¤§æ²»ç™‚ã€ã¨å‘¼ã¶ã‚ˆã€‚"
    ]
  },
  {
    story: "ğŸŒ¸ æ¬¡ã¯ã€Œç·©å’Œã‚±ã‚¢ã€ã«ã¤ã„ã¦ã®ãªãã ã‚ˆã€‚",
    title: "è¬2ï¼šã€Œç·©å’Œã‚±ã‚¢ã€ã«ã¤ã„ã¦æ­£ã—ãèª¬æ˜ã—ã¦ã„ã‚‹ã®ã¯ã©ã‚Œï¼Ÿ",
    choices: [
      {label:"1ï¼‰æœ€çµ‚æœ«æœŸã®ã¤ã‚‰ã„ç—‡çŠ¶ã‚’ç·©å’Œã™ã‚‹ã‚±ã‚¢", correct:false},
      {label:"2ï¼‰åŒ»å¸«ã¨çœ‹è­·å¸«ã€è–¬å‰¤å¸«ã®ã¿ã§æ§‹æˆã•ã‚ŒãŸãƒãƒ¼ãƒ ãŒã‚ã‚‹", correct:false},
      {label:"3ï¼‰çµŒæ¸ˆé¢ã§ã®æ”¯æ´ã¯ç·©å’Œã‚±ã‚¢ã®å¯¾è±¡ã§ã¯ãªã„", correct:false},
      {label:"4ï¼‰ãŒã‚“ã¨è¨ºæ–­ã•ã‚ŒãŸæ™‚ã‹ã‚‰ã€æ²»ç™‚ã¨ä¸¦è¡Œã—ã¦å—ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹", correct:true}
    ],
    explain: [
      "æ­£è§£ã¯ â‘£ã€‚",
      "ç·©å’Œã‚±ã‚¢ã¯ã€ç—…æ°—ã®æ—©æœŸã‹ã‚‰ã€ãŒã‚“æ²»ç™‚ã¨ä¸¦è¡Œã—ã¦è¡Œã‚ã‚Œã‚‹ã‚‚ã®ã§ã‚ã‚Šã€çµ‚æœ«æœŸã«é™ã‚‰ã‚Œã‚‹ã‚‚ã®ã§ã¯ãªã„ã‚ˆã€‚",
      "ç·©å’Œã‚±ã‚¢ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã«ã¯ã€åŒ»å¸«ã‚„çœ‹è­·å¸«ã€è–¬å‰¤å¸«ã®ä»–ã€ç®¡ç†æ „é¤Šå£«ã€ç†å­¦ç™‚æ³•å£«ã€æ­¯ç§‘å£è…”å¤–ç§‘ãƒ»æ­¯ç§‘è¡›ç”Ÿå£«ã€MSWã€è‡¨åºŠå¿ƒç†å£«ã€è‡¨åºŠå·¥å­¦æŠ€å£«ã€äº‹å‹™è·å“¡ãªã©ã€ãŸãã•ã‚“ã®å°‚é–€è·ãŒå«ã¾ã‚Œã‚‹ï¼",
      "é™¶ç”Ÿç—…é™¢ã§ã‚‚é€±ã«1å›ã€ãƒ¡ãƒ³ãƒãƒ¼ãŒé›†ã¾ã£ã¦ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’è¡Œã£ã¦ã„ã‚‹ã‚ˆã€‚"
    ]
  },
  {
    story: "ğŸ¤ æœ€å¾Œã¯ã€Œå¤šè·ç¨®é€£æºã€ã¨ãƒãƒ¼ãƒ åŒ»ç™‚ã®ãªãã ã‚ˆã€‚",
    title: "è¬3ï¼šãŒã‚“æ‚£è€…ãŒæŠ±ãˆã‚‹ã‚ã‚‰ã‚†ã‚‹å•é¡Œã«å¯¾å¿œã—ã¦ã„ããŸã‚ã«ã¯ã€å¤šè·ç¨®é€£æºãŒã™ã£ã”ãå¤§äº‹ã€‚ãƒãƒ¼ãƒ åŒ»ç™‚ã«å«ã¾ã‚Œã‚‹ã®ã¯èª°ï¼Ÿ",
    choices: [
      {label:"1ï¼‰æ‚£è€…ãƒ»å®¶æ—", correct:false},
      {label:"2ï¼‰åœ°åŸŸã®åœ¨å®…åŒ»ç™‚åŒ»å¸«ã‚„è¨ªå•çœ‹è­·å¸«", correct:false},
      {label:"3ï¼‰ã‚±ã‚¢ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", correct:false},
      {label:"4ï¼‰å…¨éƒ¨ã‚ã¦ã¯ã¾ã‚‹", correct:true}
    ],
    explain: [
      "æ­£è§£ã¯ â‘£ å…¨éƒ¨ã‚ã¦ã¯ã¾ã‚‹ã€‚",
      "æ‚£è€…ä¸€äººä¸€äººã‚’åŒ…æ‹¬çš„ã«ã‚±ã‚¢ã™ã‚‹ãŸã‚ã«ã¯ã€Œå¤šè·ç¨®é€£æºã€ãŒã¨ã¦ã‚‚å¤§åˆ‡ã€‚",
      "ç—…é™¢ã®ä¸­ã®ã‚¹ã‚¿ãƒƒãƒ•ã ã‘ã§ãªãã€æ‚£è€…ã•ã‚“æœ¬äººãƒ»å®¶æ—ã€åœ°åŸŸã®ã‹ã‹ã‚Šã¤ã‘åŒ»ã‚„è¨ªå•çœ‹è­·å¸«ã€ã‚±ã‚¢ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãªã©ã€ãŸãã•ã‚“ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒãƒãƒ¼ãƒ åŒ»ç™‚ã®ä»²é–“ã ã‚ˆã€‚",
      "é€€é™¢å¾Œã‚‚ã‚¹ãƒ ãƒ¼ã‚ºãªç™‚é¤Šç”Ÿæ´»ã‚’é€ã‚Œã‚‹ã‚ˆã†ã«ã€ç—…é™¢ã¨åœ°åŸŸãŒã¤ãªãŒã£ã¦æ”¯ãˆã¦ã„ãã“ã¨ãŒãƒã‚¤ãƒ³ãƒˆï¼"
    ]
  }
];
let quizIndex = 0;

window.toQuiz = function(){
  quizIndex = 0;
  renderQuiz();
  show(screenQuiz);
};

function renderQuiz(){
  const q = quiz[quizIndex];
  storyEl.innerHTML = q.story;

  quizImgEl.src = "mame2.png";
  quizImgEl.style.display = "inline-block";

  qTitleEl.textContent = q.title;
  choicesEl.innerHTML = "";
  judgeEl.textContent = "";
  explainEl.style.display = "none";
  explainEl.innerHTML = "";
  nextArea.style.display = "none";

  q.choices.forEach(c=>{
    const b = document.createElement('button');
    b.className = 'choice-btn';
    b.textContent = c.label;
    b.onclick = ()=>{ judge(c.correct); };
    choicesEl.appendChild(b);
  });
}

function showStamp(){
  stampEl.style.display = 'flex';
  setTimeout(()=>{ stampEl.style.display = 'none'; }, 700);
}

function judge(isCorrect){
  if(isCorrect){
    judgeEl.textContent = "æ­£è§£ï¼";
    judgeEl.className = "result ok";
    try{ seCorrect.currentTime = 0; seCorrect.play(); }catch(e){}
    showStamp();

    const q = quiz[quizIndex];
    explainEl.innerHTML = "<strong>è§£èª¬</strong><ul style='margin:6px 0 0; padding-left:18px;'>" +
      q.explain.map(t=>"<li>"+ t +"</li>").join("") + "</ul>";
    explainEl.style.display = "block";
    nextArea.style.display = "block";
  }else{
    judgeEl.textContent = "æ®‹å¿µï¼ã‚‚ã†ä¸€åº¦é¸ã‚“ã§ã¿ã‚ˆã†ã€‚";
    judgeEl.className = "result ng";
  }
}

window.goNext = function(){
  quizIndex++;
  if(quizIndex < quiz.length){
    renderQuiz();
    window.scrollTo({top:0, behavior:'smooth'});
  }else{
    const nm = (nameEl.value || "åæ¢åµ").trim();

    quizImgEl.style.display = "none";

    endingText.innerHTML =
      "<strong>" + nm + "ã•ã‚“ã€ã‚ã‚ŠãŒã¨ã†ï¼</strong><br>" +
      "ãŒã‚“è¨ºç™‚ã§ã¯æ§˜ã€…ãªå°‚é–€è·ãŒã€å‘ŠçŸ¥ã€æ²»ç™‚ã‹ã‚‰ç™‚é¤Šç”Ÿæ´»ã«è‡³ã‚‹ã¾ã§çµ±åˆçš„ã«æ”¯æ´ã—ã¦ã„ã‚‹ã‚“ã ã­ï¼ï¼<br><br>" +
      "TMCã§ã‚‚å•é¡Œã‚’è§£æ±ºã—ã¦å‰ã«é€²ã‚€ã«ã¯ã€å¹…åºƒã„çŸ¥æµã¨å½¹å‰²ãŒå¿…è¦ãã†ã€‚è‡ªåˆ†ãŸã¡ã ã‘ã§è§£æ±ºã—ã‚ˆã†ã¨æ€ã‚ãªãã¦OKï¼ãƒ†ãƒ¬ãƒ•ã‚©ãƒ³ã‚’ä¸Šæ‰‹ã«åˆ©ç”¨ã—ã‚ˆã†ã€‚<br>" +
      "ä¾‹ãˆã°â€¦è–¬å‰¤ã®ã“ã¨ã¯èª°ãŒè©³ã—ã„ï¼Ÿ éª¨æŠ˜ã—ã¦ã„ã‚‹ã²ã¨ã®å‹•ã‹ã—æ–¹ã®ãƒ—ãƒ­ã¯ï¼Ÿï¼Ÿ æ¡è¡€ã‚„è¼¸è¡€ã®ã“ã¨ã¯â€¦æ „é¤Šãƒãƒ©ãƒ³ã‚¹ã®ã“ã¨ã¯ï¼Ÿï¼Ÿ<br><br>" +
      "ã€Œã ã‚Œã€ã‚’ã€ã€Œãªã«ã€ã‚’ãƒ†ãƒ¬ãƒ•ã‚©ãƒ³ã®å…ˆã«ç”¨æ„ã™ã‚‹ã®ã‹ã€ã‚ã‚‰ã‚†ã‚‹å•é¡Œã«å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«æº–å‚™ã—ã¦ã¿ã‚ˆã†ï¼";

    show(screenEnding);
    launchConfetti();
    launchSparkles();
    try{ seClear.currentTime = 0; seClear.play(); }catch(e){}
    window.scrollTo({top:0, behavior:'smooth'});
  }
};

function launchConfetti(){
  confettiEl.innerHTML = "";
  const colors = ["#ff7ac6","#ffd166","#7bdff2","#c3f0ca","#b5b0ff"];
  for(let i=0;i<40;i++){
    const s = document.createElement('span');
    const size = 8 + Math.random()*10;
    s.style.width = size + "px";
    s.style.height = (size*1.6) + "px";
    s.style.left = (Math.random()*100) + "%";
    s.style.background = colors[Math.floor(Math.random()*colors.length)];
    s.style.animationDelay = (Math.random()*0.8) + "s";
    confettiEl.appendChild(s);
  }
}

function launchSparkles(){
  sparklesEl.innerHTML = "";
  for(let i=0;i<18;i++){
    const sp = document.createElement('div');
    sp.className = 'spark';
    sp.style.left = (Math.random()*100) + "%";
    sp.style.top  = (Math.random()*100) + "%";
    sp.style.animationDelay = (Math.random()*1.2) + "s";
    sparklesEl.appendChild(sp);
  }
}

finishBtn.addEventListener('click', function(){
  try{ bgm.pause(); }catch(e){}
  finishMessage.style.display = 'block';
  finishBtn.disabled = true;
  finishBtn.textContent = 'çµ‚äº†ã—ã¾ã—ãŸ';
});
</script>

</body>
</html>
